{% extends 'empty.html' %}

{% block top %}
    <div class="row wrapper border-bottom white-bg page-heading">
        <div class="col-lg-10">
            <h2>桥梁健康状态等级及预测</h2>
        </div>
    </div>
{% endblock %}

{% block center %}
    <div class="wrapper wrapper-content animated fadeInRight">
        <div class="row">
            <div class="col-md-6">
                <div class="ibox">
                    <div class="ibox-title">
                        <h5>当前技术状态评估</h5>
                    </div>
                    <div class="ibox-content ">
                        <form class="m-t" role="form" action="" method="post">
                            {% csrf_token %}
                            <div class="row ">
                                <div class="col-md-12">
                                    <label class="col-form-label">当前桥梁技术状态等级为：</label>
                                    <label class="col-form-label" >
                                            <span style="color: red" >
                                               <h3>{{dj}}</h3>
                                            </span>
                                    </label>
                                    <label class="col-form-label">级</label>
                                </div>
                            </div>
                            <div class="row">
                                <dt class="col-md-3">
                                    <label class="col-form-label">当前桥梁状态描述：</label>
                                </dt>
                                <dd class="col-md-9">
                                    <label class="col-form-label">{{info}}</label>
                                </dd>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="ibox ">
                    <div class="ibox-title">
                        <h5>桥梁未来技术状态查询参数设置</h5>
                    </div>
                    <div class="ibox-content" >
                        <div class="row">
                            <div class="col-md-4">
                                <label class="col-form-label">目前为止，该桥梁已服役:</label>
                            </div>
                            <div class="col-md-4">
                                <div class="input-group">
                                    <input id="attendedTime" type="text" class="form-control" placeholder="服役年数" aria-label="Year">
                                    <span class="input-group-text">年</span>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4">
                                <label class="col-form-label">预测该桥:</label>
                            </div>
                            <div class="col-md-4">
                                <div class="input-group">
                                    <input id="predictiveParameters" type="text" class="form-control" placeholder="预测年数" aria-label="Year">
                                    <span class="input-group-text">年</span>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <label class="col-form-label">后的状态等级</label>
                            </div>
                        </div>
                        <div class="hr-line-dashed"></div>
                            <div class=" form-text row">
                                <div class="col-md-4 col-md-offset-2" >
                                    <button class="btn btn-primary btn-sm" type="button"  onclick="loadXMLDoc()">
                                        查询
                                    </button>
                                    <button class="btn btn-white btn-sm" type="reset">重置</button>
                                </div>
                            </div>
                    </div>
                 </div>
            </div>
        </div>
    </div>
    <div class="wrapper wrapper-content animated fadeInRight">
        <div class="row ">
            <div class="col-md-12 ">
                <div class="ibox">
                    <div class="ibox-title">
                        <h5>模糊层次马尔科夫模型预测结果</h5>
                    </div>
                    <div class="ibox-content ">
                        <form class="m-t" role="form" action="" method="post">
                            {% csrf_token %}
                            <div class="row ">
                                <div class="col-md-4">
                                    <label class="col-form-label">预估该桥</label>
                                    <label class="col-form-label" >
                                        <span style="color: red" >
                                            <h3>
                                                <div id="year">{{year}}</div>
                                            </h3>
                                        </span>
                                    </label>
                                    <label class="col-form-label">年后的技术状态等级为</label>
                                    <label class="col-form-label" >
                                        <span style="color: red" >
                                           <h3>
                                               <div id="yuceRank">
                                                   0
                                               </div>
                                           </h3>
                                        </span>
                                    </label>
                                    <label class="col-form-label">级</label>
                                </div>
                            </div>
                            <div class="row">
                                <dt class="col-md-3">
                                    <label class="col-form-label">当前桥梁状态描述：</label>
                                </dt>
                                <dd class="col-md-9">
                                    <label class="col-form-label">
                                        <div id="yuceInfo">
                                            (预测桥梁状态）
                                        </div>
                                    </label>
                                </dd>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        function loadXMLDoc()
        {
            var  year = document.getElementById("attendedTime").value;
            var  yearYuce = document.getElementById("predictiveParameters").value;
            var params = 'year='+ year+'&yearYuce='+yearYuce;
            var xmlhttp;
            if (window.XMLHttpRequest)
            {
                //  IE7+, Firefox, Chrome, Opera, Safari 浏览器执行代码
                xmlhttp=new XMLHttpRequest();
            }
            else
            {
                // IE6, IE5 浏览器执行代码
                xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
            }
            xmlhttp.onreadystatechange=function()
            {
                if (xmlhttp.readyState==4 && xmlhttp.status==200)
                {
                    var responseText = JSON.parse(xmlhttp.responseText);
                    console.log(responseText);
                    console.log(typeof responseText.dj);
                    document.getElementById("year").innerHTML=year;
                    document.getElementById("yuceRank").innerHTML=responseText.dj;
                    document.getElementById("yuceInfo").innerHTML=responseText.info;

                }
            };
            xmlhttp.open("get","/ihsd/mytext?"+params,true);
            xmlhttp.send();


        }
        </script>
{% endblock %}

{% block script %}

{% endblock %}
